"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var h=i[e];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(t,h.key,h)}}return function(i,e,h){return e&&t(i.prototype,e),h&&t(i,h),i}}(),LiquidButton=function(){function t(i){_classCallCheck(this,t);var e=i||{};this.tension=e.tension||.4,this.width=e.width||200,this.height=e.width||50,this.margin=e.margin||50,this.padding=e.padding||17,this.hoverFactor=e.hoverFactor||-.1,this.gap=e.gap||5,this.debug=e.debug||!1,this.forceFactor=e.forceFactor||.2,this.color1=e.color1||"#fff",this.color2=e.color2||"#D37C76",this.color3=e.color3||"#C34489",this.textColor=e.textColor||"#FFFFFF",this.layers=[{points:[],viscosity:.5,mouseForce:100,forceLimit:2},{points:[],viscosity:.8,mouseForce:150,forceLimit:3}],this.text=e.text||"â¬¤",this.canvas=e.canvas||document.querySelector("canvas"),this.context=this.canvas.getContext("2d"),this.wrapperElement=e.wrapperElement||document.body,this.canvas.parentElement||this.wrapperElement.append(this.canvas),this.touches=[],this.noise=e.noise||0,this.canvas.addEventListener("mousemove",this.mousemove),this.canvas.addEventListener("mouseout",this.mouseout),this.initOrigins(),this.animate()}return t.prototype.distance=function t(i,e){return Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))},t.prototype.update=function t(){for(var i=0;i<this.layers.length;i++){for(var e=this.layers[i],h=e.points,s=0;s<h.length;s++){var o=h[s],n=o.ox-o.x+(Math.random()-.5)*this.noise,r=o.oy-o.y+(Math.random()-.5)*this.noise,a=Math.sqrt(n*n+r*r),c=a*this.forceFactor;o.vx+=c*(n/a||0),o.vy+=c*(r/a||0);for(var l=0;l<this.touches.length;l++){var g=this.touches[l],x=e.mouseForce;g.x>this.margin&&g.x<this.margin+this.width&&g.y>this.margin&&g.y<this.margin+this.height&&(x*=-this.hoverFactor);var u=o.x-g.x,v=o.y-g.y,f=Math.sqrt(u*u+v*v),y=Math.max(-e.forceLimit,Math.min(e.forceLimit,x*g.force/f));o.vx+=y*(u/f||0),o.vy+=y*(v/f||0)}o.vx*=e.viscosity,o.vy*=e.viscosity,o.x+=o.vx,o.y+=o.vy}for(var s=0;s<h.length;s++){var d=h[(s+h.length-1)%h.length],o=h[s],m=h[(s+h.length+1)%h.length],p=this.distance(o,d),w=this.distance(o,m),b={x:m.x-d.x,y:m.y-d.y},F=Math.sqrt(b.x*b.x+b.y*b.y);o.cPrev={x:o.x-b.x/F*p*this.tension,y:o.y-b.y/F*p*this.tension},o.cNext={x:o.x+b.x/F*w*this.tension,y:o.y+b.y/F*w*this.tension}}}},t.prototype.animate=function t(){var i=this;this.raf(function(){i.update(),i.draw(),i.animate()})},t.prototype.draw=function t(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var i=0;i<this.layers.length;i++){var e=this.layers[i];if(1===i)if(this.touches.length>0){var h=this.touches[0].x,s=this.touches[0].y;e.color=this.context.createRadialGradient(h,s,2*this.height,h,s,0),e.color.addColorStop(0,this.color2),e.color.addColorStop(1,this.color3)}else e.color=this.color2;else e.color=this.color1;var o=e.points;this.context.fillStyle=e.color,this.context.beginPath(),this.context.moveTo(o[0].x,o[0].y);for(var n=1;n<o.length;n+=1)this.context.bezierCurveTo(o[(n+0)%o.length].cNext.x,o[(n+0)%o.length].cNext.y,o[(n+1)%o.length].cPrev.x,o[(n+1)%o.length].cPrev.y,o[(n+1)%o.length].x,o[(n+1)%o.length].y);this.context.fill()}this.context.fillStyle=this.textColor,this.context.font="100 "+(this.height-2*this.padding)+"px sans-serif",this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText(this.text,this.canvas.width/2,this.canvas.height/2,this.width-2*this.padding),this.debug&&this.drawDebug()},t.prototype.drawDebug=function t(){this.context.fillStyle="rgba(255, 255, 255, 0.8)",this.context.fillRect(0,0,this.canvas.width,this.canvas.height);for(var i=0;i<this.layers.length;i++)for(var e=this.layers[i],h=e.points,s=0;s<h.length;s++){this.context.fillStyle=0===i?this.color1:this.color2;var o=h[s];this.context.fillRect(o.x,o.y,1,1),this.context.fillStyle="#000",this.context.fillRect(o.cPrev.x,o.cPrev.y,1,1),this.context.fillRect(o.cNext.x,o.cNext.y,1,1),this.context.strokeStyle="rgba(0, 0, 0, 0.33)",this.context.strokeWidth=.5,this.context.beginPath(),this.context.moveTo(o.cPrev.x,o.cPrev.y),this.context.lineTo(o.cNext.x,o.cNext.y),this.context.stroke()}},t.prototype.createPoint=function t(i,e){return{x:i,y:e,ox:i,oy:e,vx:0,vy:0}},t.prototype.initOrigins=function t(){this.canvas.width=this.width+2*this.margin,this.canvas.height=this.height+2*this.margin;for(var i=0;i<this.layers.length;i++){for(var e=this.layers[i],h=[],s=~~(this.height/2);s<this.width-~~(this.height/2);s+=this.gap)h.push(this.createPoint(s+this.margin,this.margin));for(var o=~~(1.25*this.height);o>=0;o-=this.gap){var n=Math.PI/~~(1.25*this.height)*o;h.push(this.createPoint(Math.sin(n)*this.height/2+this.margin+this.width-this.height/2,Math.cos(n)*this.height/2+this.margin+this.height/2))}for(var s=this.width-~~(this.height/2)-1;s>=~~(this.height/2);s-=this.gap)h.push(this.createPoint(s+this.margin,this.margin+this.height));for(var o=0;o<=~~(1.25*this.height);o+=this.gap){var n=Math.PI/~~(1.25*this.height)*o;h.push(this.createPoint(this.height-Math.sin(n)*this.height/2+this.margin-this.height/2,Math.cos(n)*this.height/2+this.margin+this.height/2))}e.points=h}},_createClass(t,[{key:"mousemove",get:function t(){var i=this;return function(t){i.touches=[{x:t.offsetX,y:t.offsetY,z:0,force:1}]}}},{key:"mouseout",get:function t(){var i=this;return function(t){i.touches=[]}}},{key:"raf",get:function t(){return this.__raf||(this.__raf=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){setTimeout(t,10)}).bind(window))}}]),t}(),redraw=function t(){button.initOrigins()},button=new LiquidButton;